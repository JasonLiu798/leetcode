--Delete Duplicate Emails
--https://leetcode.com/problems/delete-duplicate-emails/

--not pass
--You can't specify target table 'Person' for update in FROM clause
--http://blog.163.com/xiaoqiu_1120/blog/static/121632322007112411424982/


--Runtime Error Message:
Subquery returns more than 1 row
{"headers": {"Person": ["Id", "Email"]},
"rows": {"Person": [[2, "jacky@yahoo.com"], [1, "jacky@yahoo.com"], [3, "jacky@yahoo.com"]]}}


--Time Limit ExceededMore Details
Last executed input:
{"headers": {"Person": ["Id", "Email"]}, "rows": {"Person": [[261, "jdii"], [129, "ebjec"], [189, "kkhjg"], [4, "edhj"], [489, "edhgd"], [10, "gecie"], [92, "bcbki"], [331, "hjie"], [406, "ekeee"], [14, "fjd"], [170, "jkch"], [78, "eih"], [235, "bgb"], [312, "kig"], [299, "ffk"], [488, "hebcc"], [148, "dehh"], [139, "gckk"], [97, "igb"], [437, "khbcg"], [334, "bcdg"], [298, "eif"], [181, "feb"], [402, "kcicf"], [60, "eicfd"], [297, "iddbg"], [429, "dcb"], [365, "dgh"], [211, "jjiki"], [160, "jeh"], [417, "hcjbc"], [332, "fdi"], [314, "cgj"], [187, "hifb"], [207, "ggb"], [77, "dhbgf"], [146, "egc"], [124, "hck"], [122, "jgjcd"], [333, "jhjc"], [310, "hibih"], [411, "ffeg"], [447, "bibkh"], [229, "bkk"], [293, "fidgc"], [24, "fdei"], [349, "kei"], [315, "hcj"], [291, "gkje"], [491, "dcf"], [185, "chg"], [136, "jekf"], [62, "jdd"], [104, "gdgg"], [322, "ekj"], [135, "idc"], [496, "bffib"], [259, "bibk"], [308, "dgc"], [91, "fch"], [375, "kfk"], [224, "gdbd"], [470, "cddee"], [480, "fgjh"], [33, "fbde"], [273, "dbg"], [450, "ebbgd"], [383, "gijj"], [228, "cebb"], [174, "ebgc"], [338, "dgi"], [461, "bceb"], [335, "ggbe"], [309, "ckgbe"], [290, "ebhfe"], [233, "jhjif"], [61, "jche"], [270, "chcd"], [327, "figb"], [289, "ieec"], [280, "kbj"], [445, "gjijk"], [13, "jghi"], [436, "fghe"], [296, "jedgj"], [30, "kcffe"], [278, "kbfe"], [138, "chi"], [323, "icb"], [113, "iebhe"], [16, "hcek"], [262, "fifh"], [169, "cdf"], [47, "gfi"], [234, "begge"], [114, "ckbbf"], [5, "cdkg"], [420, "jffb"], [341, "eeh"], [362, "ifd"], [493, "ggd"], [118, "kdh"], [131, "bgkif"], [68, "gkikf"], [38, "jghec"], [63, "djg"], [197, "dceg"], [449, "ige"], [306, "hij"], [123, "eib"], [180, "bjigk"], [72, "bkkk"], [354, "kgdj"], [255, "fdh"], [226, "dbg"], [389, "icic"], [191, "kbj"], [386, "ddfbf"], [204, "dbhb"], [219, "kei"], [179, "kec"], [150, "idbc"], [446, "bji"], [295, "dcbi"], [348, "hkbe"], [347, "ifjfc"], [245, "hbgkk"], [67, "kgcj"], [319, "fbg"], [237, "ghei"], [403, "chch"], [208, "fkhhb"], [460, "hgg"], [168, "iigh"], [462, "ceg"], [390, "jhfjg"], [316, "chii"], [218, "ijde"], [25, "hbddf"], [407, "djec"], [142, "jff"], [198, "edfg"], [205, "jideg"], [55, "ddjk"], [201, "keg"], [161, "hfe"], [23, "hhdc"], [484, "gcfdk"], [311, "kcf"], [56, "fdfh"], [258, "kgg"], [19, "gefj"], [54, "bigke"], [392, "jbgf"], [325, "dbhc"], [175, "icbg"], [231, "jbkc"], [11, "cfdh"], [370, "jgb"], [106, "ifh"], [393, "cfd"], [64, "jifh"], [287, "kejd"], [277, "feik"], [268, "icf"], [475, "jdie"], [220, "kjdjf"], [52, "kjg"], [166, "becig"], [441, "hhb"], [423, "kcke"], [203, "jijij"], [409, "ehg"], [448, "dce"], [213, "cedk"], [360, "gfc"], [344, "ijg"], [157, "beg"], [408, "dfegk"], [51, "fkigg"], [415, "ejee"], [324, "ckdc"], [416, "ekc"], [285, "ekfbk"], [90, "ecb"], [153, "khc"], [206, "jjcd"], [57, "bkbkd"], [151, "kgc"], [391, "jdhk"], [44, "bfj"], [34, "eijjg"], [84, "kjkhk"], [339, "iifih"], [216, "fch"], [454, "jbj"], [317, "kce"], [478, "ehfcg"], [29, "cgkd"], [196, "hggkc"], [442, "jdfgj"], [79, "jjckj"], [267, "ejhih"], [443, "ekfcd"], [107, "khi"], [301, "cgie"], [80, "gijbj"], [242, "ckifh"], [163, "cdjdj"], [387, "cjgjc"], [378, "kfjeh"], [89, "hhd"], [35, "jkjjb"], [413, "hhf"], [292, "ejf"], [115, "bibfj"], [244, "kkf"], [48, "eed"], [272, "fgkih"], [31, "jghek"], [397, "fikb"], [241, "cfd"], [329, "fhj"], [463, "cdcef"], [49, "hjfj"], [495, "hbjkh"], [330, "dje"], [147, "cik"], [263, "kbki"], [76, "jjick"], [388, "gihkk"], [432, "jckch"], [12, "ecb"], [154, "cjjdf"], [249, "jdg"], [202, "gecb"], [32, "hjk"], [396, "dighb"], [424, "djh"], [434, "kfj"], [425, "hjb"], [99, "ihe"], [382, "gib"], [469, "jbj"], [214, "eef"], [271, "ffcdj"], [367, "icch"], [257, "ecbb"], [143, "iki"], [419, "fhj"], [190, "ddj"], [112, "kji"], [361, "hfidf"], [305, "cfcj"], [364, "fehf"], [109, "hgce"], [134, "kefh"], [400, "ifc"], [359, "bceff"], [422, "iji"], [471, "jbgh"], [6, "ckfci"], [459, "ifkj"], [182, "ggfd"], [452, "gjcb"], [456, "kgc"], [59, "ccc"], [7, "gdi"], [485, "hfifh"], [385, "gbdhb"], [284, "iikh"], [102, "efgb"], [398, "dffb"], [1, "fecfd"], [279, "gcb"], [412, "egk"], [304, "bbcbg"], [217, "dfc"], [326, "fge"], [254, "djhk"], [149, "cge"], [474, "jkfh"], [50, "hfkgd"], [468, "kkkk"], [252, "fgeb"], [58, "jdfh"], [3, "ciif"], [238, "fgkee"], [121, "hckh"], [318, "khif"], [152, "cfg"], [178, "ekejd"], [200, "bkkhg"], [87, "chfc"], [126, "eghbi"], [188, "gkici"], [313, "ijih"], [137, "che"], [71, "edj"], [66, "fdihd"], [342, "digid"], [21, "hgc"], [498, "jjh"], [192, "ieeib"], [302, "gfk"], [266, "eck"], [130, "dgee"], [186, "ckfek"], [246, "bbgej"], [177, "idibb"], [427, "ifcdg"], [18, "dkke"], [336, "gfj"], [132, "hdi"], [380, "fib"], [337, "jdhdg"], [103, "dgjff"], [487, "ied"], [194, "gcbg"], [145, "gfihd"], [119, "dhkd"], [384, "jci"], [20, "jgh"], [167, "kfcbd"], [0, "cggfd"], [457, "gif"], [195, "gke"], [9, "bjcbc"], [41, "cdbde"], [176, "fdjdk"], [46, "fib"], [256, "bgdfd"], [499, "ghih"], [120, "kdj"], [351, "eedif"], [294, "kchch"], [232, "dkbei"], [486, "heb"], [421, "cfffi"], [253, "bgdd"], [481, "igiik"], [282, "ikk"], [36, "ibigf"], [212, "cig"], [239, "hkk"], [431, "igk"], [466, "hbff"], [209, "bgbb"], [451, "ccd"], [472, "cjjkb"], [438, "jcgig"], [371, "jikg"], [433, "hkig"], [286, "fecdk"], [440, "figk"], [70, "hgckb"], [42, "gdg"], [172, "jjhie"], [183, "dckif"], [65, "bfijh"], [222, "jfbd"], [26, "bhhbk"], [158, "dbg"], [275, "jchch"], [464, "ifi"], [453, "cceej"], [353, "ibf"], [455, "cbee"], [260, "eic"], [85, "fkcb"], [372, "dfdc"], [265, "jicj"], [159, "bgc"], [86, "ccfkb"], [395, "gice"], [281, "cdbf"], [357, "idhi"], [381, "ffgc"], [156, "beh"], [340, "gdccb"], [247, "hkci"], [377, "ggc"], [394, "ehjbi"], [458, "hjbd"], [133, "hhdef"], [116, "hdkf"], [376, "cbf"], [39, "kcebg"], [127, "gggj"], [250, "fgjk"], [17, "jic"], [215, "gifk"], [307, "gjhgh"], [83, "hhb"], [405, "jbh"], [225, "edgc"], [476, "jedi"], [328, "igj"], [404, "ckbj"], [300, "jbcb"], [358, "bijjh"], [43, "gkg"], [73, "gcdg"], [477, "hfg"], [243, "dhj"], [264, "kdiff"], [164, "fgdhk"], [2, "ffc"], [352, "idic"], [236, "ieb"], [199, "jkj"], [45, "dbd"], [356, "hjdf"], [350, "ehkgc"], [366, "ihchh"], [492, "ieeie"], [269, "hjk"], [363, "dgki"], [465, "ijbbk"], [94, "dijkg"], [430, "cjcb"], [355, "kdj"], [111, "efbgf"], [426, "cgb"], [276, "eig"], [428, "ikd"], [69, "gcc"], [494, "fdg"], [343, "fbjc"], [101, "fbff"], [40, "bgcc"], [321, "jbeif"], [320, "bicgc"], [497, "gjeik"], [74, "ickgb"], [418, "gib"], [399, "hgceb"], [435, "cbgid"], [125, "dhedf"], [223, "ejegd"], [15, "bhhi"], [374, "idi"], [27, "ihc"], [141, "hffd"], [345, "kdi"], [95, "gfic"], [414, "fgd"], [288, "ihkk"], [96, "fgg"], [88, "gfj"], [22, "bjf"], [100, "fidjf"], [140, "fjcg"], [248, "dbhb"], [283, "dbffh"], [303, "dhg"], [82, "efedg"], [162, "dkfhe"], [227, "ebc"], [467, "jeidd"], [144, "jje"], [155, "ekee"], [53, "echf"], [171, "kjde"], [230, "hhjkf"], [173, "ehi"], [274, "hkgfd"], [81, "ffegk"], [128, "ijdf"], [165, "kike"], [473, "dbifi"], [210, "dgh"], [110, "dicci"], [221, "ggj"], [490, "gdgjd"], [369, "gkffj"], [251, "ijdc"], [240, "dii"], [93, "gccf"], [439, "bib"], [117, "eec"], [410, "hihhd"], [75, "ibhkb"], [373, "jbhhe"], [368, "bbkjd"], [482, "fkkk"], [346, "gff"], [193, "cgekf"], [8, "edkfg"], [483, "ejk"], [444, "cie"], [108, "ijg"], [479, "iddi"], [401, "efecj"], [28, "bbi"], [184, "heggi"], [98, "bfghj"], [105, "ieji"], [379, "ebgge"], [37, "kcced"]]}}

--solution time Limit
delete from Person where Id in (
	select id from (
		select p.Id from Person p where p.Id not in(
			select min(p2.Id) from Person p2 group by p2.Email
		)
	)tmp
)


--final solution
delete from Person where Id not in ( select A.Id from (select min(Id) as Id from Person GROUP BY Email) A )

DELETE p from Person p, Person q where p.Id>q.Id AND q.Email=p.Email







